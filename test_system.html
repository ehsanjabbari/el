<!DOCTYPE html>
<html lang="fa" dir="rtl">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>ØªØ³Øª Ø³ÛŒØ³ØªÙ… ÙØ§Ú©ØªÙˆØ± Ú†Ù†Ø¯ Ù…Ø­ØµÙˆÙ„Ù‡ - Ù†Ø³Ø®Ù‡ Ø§ØµÙ„Ø§Ø­ Ø´Ø¯Ù‡</title>
    <link rel="preconnect" href="https://fonts.googleapis.com">
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
    <link href="https://fonts.googleapis.com/css2?family=Vazirmatn:wght@400;500;600;700&display=swap" rel="stylesheet">
    <link rel="stylesheet" href="styles.css">
    <style>
        body { 
            font-family: 'Vazirmatn', Arial, sans-serif; 
            margin: 20px; 
            background: #f5f5f5; 
        }
        .test-section { 
            background: white; 
            padding: 20px; 
            margin: 20px 0; 
            border-radius: 8px; 
            box-shadow: 0 2px 10px rgba(0,0,0,0.1); 
        }
        .btn { 
            background: #4CAF50; 
            color: white; 
            padding: 10px 20px; 
            border: none; 
            border-radius: 5px; 
            cursor: pointer; 
            margin: 5px; 
            font-family: 'Vazirmatn', Arial, sans-serif;
        }
        .btn:hover { background: #45a049; }
        .btn-danger { background: #f44336; }
        .btn-danger:hover { background: #da190b; }
        .btn-info { background: #2196F3; }
        .btn-info:hover { background: #1976D2; }
        .result { 
            margin-top: 15px; 
            padding: 15px; 
            background: #e8f5e8; 
            border-radius: 5px; 
            border: 1px solid #4CAF50; 
        }
        .error { 
            background: #ffe8e8; 
            border-color: #f44336; 
            color: #d32f2f; 
        }
        .status-ok { color: #4CAF50; }
        .status-error { color: #f44336; }
    </style>
</head>
<body>
    <h1>ğŸ”§ ØªØ³Øª Ø³ÛŒØ³ØªÙ… ÙØ§Ú©ØªÙˆØ± Ú†Ù†Ø¯ Ù…Ø­ØµÙˆÙ„Ù‡ - Ù†Ø³Ø®Ù‡ Ø§ØµÙ„Ø§Ø­ Ø´Ø¯Ù‡</h1>
    <p><strong>Ø¢Ø®Ø±ÛŒÙ† Ø§ØµÙ„Ø§Ø­:</strong> Ø±ÙØ¹ Ù…Ø´Ú©Ù„ Ø§ÙØ²ÙˆØ¯Ù† Ù…Ø­ØµÙˆÙ„ Ø¯Ø± ÙØ§Ú©ØªÙˆØ± ÙØ±ÙˆØ´</p>
    
    <div class="test-section">
        <h2>ğŸ“¦ ØªØ³Øª Ù…Ø¯ÛŒØ±ÛŒØª Ù…Ø­ØµÙˆÙ„Ø§Øª</h2>
        <button class="btn" onclick="addTestProduct('Ù…Ø­ØµÙˆÙ„ ØªØ³Øª Û±')">Ø§ÙØ²ÙˆØ¯Ù† Ù…Ø­ØµÙˆÙ„ ØªØ³Øª Û±</button>
        <button class="btn" onclick="addTestProduct('Ù…Ø­ØµÙˆÙ„ ØªØ³Øª Û²')">Ø§ÙØ²ÙˆØ¯Ù† Ù…Ø­ØµÙˆÙ„ ØªØ³Øª Û²</button>
        <button class="btn" onclick="addTestProduct('Ù…Ø­ØµÙˆÙ„ ØªØ³Øª Û³')">Ø§ÙØ²ÙˆØ¯Ù† Ù…Ø­ØµÙˆÙ„ ØªØ³Øª Û³</button>
        <button class="btn-info" onclick="createInputInvoices()">Ø§ÛŒØ¬Ø§Ø¯ ÙØ§Ú©ØªÙˆØ± ÙˆØ±ÙˆØ¯ÛŒ Ø¨Ø±Ø§ÛŒ Ù‡Ù…Ù‡ Ù…Ø­ØµÙˆÙ„Ø§Øª</button>
        <button class="btn btn-danger" onclick="clearProducts()">Ø­Ø°Ù Ù‡Ù…Ù‡ Ù…Ø­ØµÙˆÙ„Ø§Øª</button>
        <div id="productsResult"></div>
    </div>
    
    <div class="test-section">
        <h2>ğŸ“„ ØªØ³Øª ÙØ§Ú©ØªÙˆØ± ÙˆØ±ÙˆØ¯ÛŒ</h2>
        <button class="btn" onclick="createInputInvoice()">Ø§ÛŒØ¬Ø§Ø¯ ÙØ§Ú©ØªÙˆØ± ÙˆØ±ÙˆØ¯ÛŒ Ø¬Ø¯ÛŒØ¯</button>
        <button class="btn" onclick="addProductToInput()">Ø§ÙØ²ÙˆØ¯Ù† Ù…Ø­ØµÙˆÙ„ Ø¨Ù‡ ÙØ§Ú©ØªÙˆØ± ÙˆØ±ÙˆØ¯ÛŒ</button>
        <button class="btn btn-danger" onclick="closeModal()">Ø¨Ø³ØªÙ† Ù…ÙˆØ¯Ø§Ù„</button>
        <div id="inputInvoiceResult"></div>
    </div>
    
    <div class="test-section">
        <h2>ğŸ’° ØªØ³Øª ÙØ§Ú©ØªÙˆØ± ÙØ±ÙˆØ´</h2>
        <button class="btn" onclick="createSalesInvoice()">Ø§ÛŒØ¬Ø§Ø¯ ÙØ§Ú©ØªÙˆØ± ÙØ±ÙˆØ´ Ø¬Ø¯ÛŒØ¯</button>
        <button class="btn" onclick="addProductToSales()">Ø§ÙØ²ÙˆØ¯Ù† Ù…Ø­ØµÙˆÙ„ Ø¨Ù‡ ÙØ§Ú©ØªÙˆØ± ÙØ±ÙˆØ´</button>
        <button class="btn btn-danger" onclick="closeModal()">Ø¨Ø³ØªÙ† Ù…ÙˆØ¯Ø§Ù„</button>
        <div id="salesInvoiceResult"></div>
    </div>
    
    <div class="test-section">
        <h2>ğŸ“Š Ù†Ù…Ø§ÛŒØ´ Ø¯Ø§Ø¯Ù‡â€ŒÙ‡Ø§</h2>
        <button class="btn" onclick="showInventory()">Ù†Ù…Ø§ÛŒØ´ Ø§Ù†Ø¨Ø§Ø±</button>
        <button class="btn" onclick="showInputInvoices()">Ù†Ù…Ø§ÛŒØ´ ÙØ§Ú©ØªÙˆØ±Ù‡Ø§ÛŒ ÙˆØ±ÙˆØ¯ÛŒ</button>
        <button class="btn" onclick="showSalesInvoices()">Ù†Ù…Ø§ÛŒØ´ ÙØ§Ú©ØªÙˆØ±Ù‡Ø§ÛŒ ÙØ±ÙˆØ´</button>
        <button class="btn btn-danger" onclick="clearAllData()">Ø­Ø°Ù Ù‡Ù…Ù‡ Ø¯Ø§Ø¯Ù‡â€ŒÙ‡Ø§</button>
        <div id="dataResult"></div>
    </div>

    <script src="app.js"></script>
    <script>
        // Ù…ØªØ¯Ù‡Ø§ÛŒ ØªØ³Øª
        function addTestProduct(name) {
            try {
                // Ø¨Ø±Ø±Ø³ÛŒ Ø§ÛŒÙ†Ú©Ù‡ Ø¢ÛŒØ§ Ù…Ø­ØµÙˆÙ„ Ø§Ø² Ù‚Ø¨Ù„ ÙˆØ¬ÙˆØ¯ Ø¯Ø§Ø±Ø¯
                const existingProducts = app.getAllProducts();
                if (existingProducts.some(p => p.name === name)) {
                    throw new Error('Ø§ÛŒÙ† Ù…Ø­ØµÙˆÙ„ Ù‚Ø¨Ù„Ø§Ù‹ Ø§Ø¶Ø§ÙÙ‡ Ø´Ø¯Ù‡ Ø§Ø³Øª');
                }
                
                app.addProduct(name);
                document.getElementById('productsResult').innerHTML = 
                    `<div class="result"><span class="status-ok">âœ…</span> Ù…Ø­ØµÙˆÙ„ "${name}" Ø¨Ø§ Ù…ÙˆÙÙ‚ÛŒØª Ø§Ø¶Ø§ÙÙ‡ Ø´Ø¯</div>`;
            } catch (error) {
                document.getElementById('productsResult').innerHTML = 
                    `<div class="result error"><span class="status-error">âŒ</span> Ø®Ø·Ø§: ${error.message}</div>`;
            }
        }
        
        function createInputInvoices() {
            try {
                const products = app.getAllProducts();
                if (products.length === 0) {
                    throw new Error('Ù‡ÛŒÚ† Ù…Ø­ØµÙˆÙ„ÛŒ Ø¨Ø±Ø§ÛŒ Ø§ÛŒØ¬Ø§Ø¯ ÙØ§Ú©ØªÙˆØ± ÙˆØ¬ÙˆØ¯ Ù†Ø¯Ø§Ø±Ø¯');
                }
                
                // Ø§ÛŒØ¬Ø§Ø¯ ÙØ§Ú©ØªÙˆØ± ÙˆØ±ÙˆØ¯ÛŒ Ø¨Ø±Ø§ÛŒ Ù‡Ø± Ù…Ø­ØµÙˆÙ„
                let successCount = 0;
                products.forEach(product => {
                    try {
                        const invoice = {
                            id: Date.now() + Math.random(),
                            date: new Date().toISOString().split('T')[0],
                            products: [{
                                productId: product.id,
                                productName: product.name,
                                quantity: 10,
                                description: 'Ù…Ø­ØµÙˆÙ„ ØªØ³Øª'
                            }],
                            createdAt: new Date().toISOString()
                        };
                        
                        const invoices = JSON.parse(localStorage.getItem('inputInvoices') || '[]');
                        invoices.push(invoice);
                        localStorage.setItem('inputInvoices', JSON.stringify(invoices));
                        
                        // Ø¨Ù‡ Ø±ÙˆØ²Ø±Ø³Ø§Ù†ÛŒ Ø§Ù†Ø¨Ø§Ø±
                        const inventory = JSON.parse(localStorage.getItem('inventory') || '{}');
                        if (!inventory[product.id]) {
                            inventory[product.id] = { product: product, currentStock: 0, totalAdded: 0, totalSold: 0 };
                        }
                        inventory[product.id].currentStock += 10;
                        inventory[product.id].totalAdded += 10;
                        localStorage.setItem('inventory', JSON.stringify(inventory));
                        
                        successCount++;
                    } catch (error) {
                        console.error('Error creating invoice for', product.name, error);
                    }
                });
                
                document.getElementById('productsResult').innerHTML = 
                    `<div class="result"><span class="status-ok">âœ…</span> ${successCount} ÙØ§Ú©ØªÙˆØ± ÙˆØ±ÙˆØ¯ÛŒ Ø¨Ø±Ø§ÛŒ Ù…Ø­ØµÙˆÙ„Ø§Øª Ø§ÛŒØ¬Ø§Ø¯ Ø´Ø¯</div>`;
            } catch (error) {
                document.getElementById('productsResult').innerHTML = 
                    `<div class="result error"><span class="status-error">âŒ</span> Ø®Ø·Ø§: ${error.message}</div>`;
            }
        }
        
        function clearProducts() {
            localStorage.removeItem('products');
            localStorage.removeItem('inventory');
            document.getElementById('productsResult').innerHTML = 
                '<div class="result"><span class="status-ok">ğŸ—‘ï¸</span> Ù‡Ù…Ù‡ Ù…Ø­ØµÙˆÙ„Ø§Øª Ùˆ Ø§Ù†Ø¨Ø§Ø± Ø­Ø°Ù Ø´Ø¯Ù†Ø¯</div>';
        }
        
        function createInputInvoice() {
            try {
                app.showAddInputInvoiceModal();
                document.getElementById('inputInvoiceResult').innerHTML = 
                    '<div class="result"><span class="status-ok">âœ…</span> ÙØ§Ú©ØªÙˆØ± ÙˆØ±ÙˆØ¯ÛŒ Ø§ÛŒØ¬Ø§Ø¯ Ø´Ø¯ - Ø­Ø§Ù„Ø§ Ù…ÛŒâ€ŒØªÙˆØ§Ù†ÛŒØ¯ Ù…Ø­ØµÙˆÙ„Ø§Øª Ø§Ø¶Ø§ÙÙ‡ Ú©Ù†ÛŒØ¯</div>';
            } catch (error) {
                document.getElementById('inputInvoiceResult').innerHTML = 
                    `<div class="result error"><span class="status-error">âŒ</span> Ø®Ø·Ø§: ${error.message}</div>`;
            }
        }
        
        function addProductToInput() {
            try {
                app.addInputInvoiceItem();
                document.getElementById('inputInvoiceResult').innerHTML = 
                    '<div class="result"><span class="status-ok">âœ…</span> Ù…Ø­ØµÙˆÙ„ Ø¬Ø¯ÛŒØ¯ Ø¨Ù‡ ÙØ§Ú©ØªÙˆØ± ÙˆØ±ÙˆØ¯ÛŒ Ø§Ø¶Ø§ÙÙ‡ Ø´Ø¯</div>';
            } catch (error) {
                document.getElementById('inputInvoiceResult').innerHTML = 
                    `<div class="result error"><span class="status-error">âŒ</span> Ø®Ø·Ø§: ${error.message}</div>`;
            }
        }
        
        function createSalesInvoice() {
            try {
                app.showAddSalesInvoiceModal();
                document.getElementById('salesInvoiceResult').innerHTML = 
                    '<div class="result"><span class="status-ok">âœ…</span> ÙØ§Ú©ØªÙˆØ± ÙØ±ÙˆØ´ Ø§ÛŒØ¬Ø§Ø¯ Ø´Ø¯ - Ø­Ø§Ù„Ø§ Ù…ÛŒâ€ŒØªÙˆØ§Ù†ÛŒØ¯ Ù…Ø­ØµÙˆÙ„Ø§Øª Ø§Ø¶Ø§ÙÙ‡ Ú©Ù†ÛŒØ¯</div>';
            } catch (error) {
                document.getElementById('salesInvoiceResult').innerHTML = 
                    `<div class="result error"><span class="status-error">âŒ</span> Ø®Ø·Ø§: ${error.message}</div>`;
            }
        }
        
        function addProductToSales() {
            try {
                app.addSalesInvoiceItem();
                document.getElementById('salesInvoiceResult').innerHTML = 
                    '<div class="result"><span class="status-ok">âœ…</span> Ù…Ø­ØµÙˆÙ„ Ø¬Ø¯ÛŒØ¯ Ø¨Ù‡ ÙØ§Ú©ØªÙˆØ± ÙØ±ÙˆØ´ Ø§Ø¶Ø§ÙÙ‡ Ø´Ø¯</div>';
            } catch (error) {
                document.getElementById('salesInvoiceResult').innerHTML = 
                    `<div class="result error"><span class="status-error">âŒ</span> Ø®Ø·Ø§: ${error.message}</div>`;
            }
        }
        
        function closeModal() {
            try {
                app.hideModal();
                document.getElementById('inputInvoiceResult').innerHTML = 
                    '<div class="result">âŒ Ù…ÙˆØ¯Ø§Ù„ Ø¨Ø³ØªÙ‡ Ø´Ø¯</div>';
                document.getElementById('salesInvoiceResult').innerHTML = 
                    '<div class="result">âŒ Ù…ÙˆØ¯Ø§Ù„ Ø¨Ø³ØªÙ‡ Ø´Ø¯</div>';
            } catch (error) {
                console.error('Error closing modal:', error);
            }
        }
        
        function showInventory() {
            const inventory = app.getInventory();
            const products = app.getAllProducts();
            
            let html = '<h4>ğŸ“¦ Ù…Ø­ØµÙˆÙ„Ø§Øª Ù…ÙˆØ¬ÙˆØ¯:</h4><ul>';
            products.forEach(product => {
                const stock = inventory[product.id]?.currentStock || 0;
                html += `<li>${product.name}: ${stock} Ø¹Ø¯Ø¯</li>`;
            });
            html += '</ul>';
            
            document.getElementById('dataResult').innerHTML = html;
        }
        
        function showInputInvoices() {
            const invoices = JSON.parse(localStorage.getItem('inputInvoices') || '[]');
            let html = '<h4>ğŸ“„ ÙØ§Ú©ØªÙˆØ±Ù‡Ø§ÛŒ ÙˆØ±ÙˆØ¯ÛŒ:</h4>';
            invoices.forEach(invoice => {
                html += `<div style="border: 1px solid #ddd; padding: 10px; margin: 5px 0;">
                    <strong>ÙØ§Ú©ØªÙˆØ± ${invoice.id.toString().slice(-6)}</strong> - ØªØ§Ø±ÛŒØ®: ${invoice.date}
                    <br>ØªØ¹Ø¯Ø§Ø¯ Ù…Ø­ØµÙˆÙ„Ø§Øª: ${invoice.products.length}
                </div>`;
            });
            
            document.getElementById('dataResult').innerHTML = html || '<p>ÙØ§Ú©ØªÙˆØ± ÙˆØ±ÙˆØ¯ÛŒ ÙˆØ¬ÙˆØ¯ Ù†Ø¯Ø§Ø±Ø¯</p>';
        }
        
        function showSalesInvoices() {
            const invoices = JSON.parse(localStorage.getItem('salesInvoices') || '[]');
            let html = '<h4>ğŸ’° ÙØ§Ú©ØªÙˆØ±Ù‡Ø§ÛŒ ÙØ±ÙˆØ´:</h4>';
            invoices.forEach(invoice => {
                html += `<div style="border: 1px solid #ddd; padding: 10px; margin: 5px 0;">
                    <strong>ÙØ§Ú©ØªÙˆØ± ${invoice.id.toString().slice(-6)}</strong> - ØªØ§Ø±ÛŒØ®: ${invoice.date}
                    <br>ØªØ¹Ø¯Ø§Ø¯ Ù…Ø­ØµÙˆÙ„Ø§Øª: ${invoice.products.length}
                </div>`;
            });
            
            document.getElementById('dataResult').innerHTML = html || '<p>ÙØ§Ú©ØªÙˆØ± ÙØ±ÙˆØ´ ÙˆØ¬ÙˆØ¯ Ù†Ø¯Ø§Ø±Ø¯</p>';
        }
        
        function clearAllData() {
            localStorage.clear();
            document.getElementById('dataResult').innerHTML = 
                '<div class="result">ğŸ—‘ï¸ Ù‡Ù…Ù‡ Ø¯Ø§Ø¯Ù‡â€ŒÙ‡Ø§ Ø­Ø°Ù Ø´Ø¯Ù†Ø¯</div>';
        }
        
        // Ø¨Ø§Ø±Ú¯Ø°Ø§Ø±ÛŒ Ø§ÙˆÙ„ÛŒÙ‡
        window.addEventListener('load', function() {
            console.log('ğŸ”§ Ø³ÛŒØ³ØªÙ… ØªØ³Øª Ø¢Ù…Ø§Ø¯Ù‡ Ø§Ø³Øª - Ù†Ø³Ø®Ù‡ Ø§ØµÙ„Ø§Ø­ Ø´Ø¯Ù‡');
            console.log('ğŸ“ ÙØ§ÛŒÙ„â€ŒÙ‡Ø§ÛŒ Ù…ÙˆØ¬ÙˆØ¯:', ['app.js', 'index.html', 'styles.css', 'test_system.html']);
            console.log('ğŸ” Ø¢Ø®Ø±ÛŒÙ† Ø§ØµÙ„Ø§Ø­: Ø±ÙØ¹ Ù…Ø´Ú©Ù„ Ø§ÙØ²ÙˆØ¯Ù† Ù…Ø­ØµÙˆÙ„ Ø¯Ø± ÙØ§Ú©ØªÙˆØ± ÙØ±ÙˆØ´');
        });
    </script>
</body>
</html>